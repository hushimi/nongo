---
alwaysApply: false
---
# Project Plan for Spring Boot + SvelteKit Full-Stack App

```plan
# --- Current Focus ---
currentFocus:
  - Implement password reset function
    1. User request password reset
    2. User input own email
      - if email is not existed on server, show error message
    3. Password reset email will be sent
      - create one token per user
      - if user request multiple reset token, update existed record
    4. User clicks link with password reset token
    5. User will reset password

  DATABASE:
  - create password_reset_tokens table
    - id(PK), user_id(FK), token, expires_at, is_active, created_at, updated_at
    - If you have any suggestions for table column tell me
  - Generate mybatis code(.\gradlew mybatisGenerate)

  BACKEND:
    - Send password reset function
      - make sure email is existed in database
        - if not return error message that frontend can handle it
      - If email is existed in database, send reset url with token
    - Reset password function
      - validate password and confirm password is same
      - validate password format same as signup
      - validate token is existed in database
      - if token is valid reset password
        - redirect user to login page
    - Generate type script api code

  FRONTEND:
    - create request password reset page
      - can show backend error
      - layout should be look professional
      - use component as possible as you can
    - create password reset page
      - can show validation error
      - layout should be look professional
      - use component as possible as you can

  INTEGRATION:
    - Generate mybatis and typescript code

  MAIL
    -

# --- Next Steps ---
next:
  BACKEND:
    -
  FRONTEND:
    -

  DATABASE:
    -
  INTEGRATION:
    -

# --- Completed Tasks ---
completed:
  BACKEND:
    - create signup api in LoginController.java
      - user should input user_name, email and password
      - validation rule
        - user_name: a-z, A-Z, 0-9, more than 5 character (implemented as 6+ alphanumeric)
        - email: valid email type
        - password: more than 8 character, must include number and '!@?_#&'
    - created SignupRequest DTO with validation annotations
    - created UsersService with signup method (checks for duplicate user_name and email)
    - added signup endpoint to LoginController with validation logic
    - updated SecurityConfig to allow /signup endpoint
    - create login api and issue JWT token with HTTP only cookie
    - currently, this app make request to /api/software-engineers to check if token is valid
      - create /api/is-token-valid API(POST) in LoginController
      - this api just return token is valid or not(don't return 401 error)
    - create logout api
    - After sign up, send verification email
      - when signup, email_verification_tokens record will be created
      - should install spring-boot-starter-mail
      - use mailhog for admin environment(use gmail for production environment)
      - mail sentence can be modified via template block
      - Until account is verified, user can not login

  FRONTEND:
    - create signup page using tailwind and daisyUI
      - created reusable TextInput component
      - created reusable PasswordInput component with toggle visibility
      - created signup page at /signup with form using Tailwind and DaisyUI
    - create login page
    - once login is succeeded, move to top page. When user have JWT token, software engineer list menu will be shown
    - fix auth.ts to use is-token-valid api(AuthenticationApi.ts)
    - create common header component
      - Left side: nongo application menu(link to top page)
      - Right side menu:
        - If is-token-valid result is true, display logout button
          - create logout function using generated type script client class(AuthenticationApi.class)
        - IF is-token-valid result is false, display SignUp and Log In button
    - once logout request is succeeded, move to top page, software engineer list can not be shown. Just login and signup menu
    - Display "アカウント認証メールを送信しました" in sign up page after send mail succeeded
    - When login failed, handle 403 error and display alert message in login page
    - create error handling page
      - if token is not valid, redirect to this page
      - This page will be used for other error to
      - error message can be flexible depends on error type

  DATABASE:
    - Add verification column to users table(Default false). If record is already existed, set true
      - Create an Email verification token table
        - 1 user > 1 active token
        - token cleanup if user is deleted

  INTEGRATION:
    - regenerated OpenAPI client types (npm run gen-tscode)
    - updated signup page to use generated AuthenticationApi.signupRaw with handleApiPost
    - signup page now uses api.ts utility for consistent error handling

  MAIL:
    - Changed verification mail to professional HTML format
      - Beautiful gradient header with nongo branding
      - Prominent call-to-action button for account verification
      - Fallback URL for users whose email clients don't support buttons
      - Warning box highlighting 24-hour expiration
      - Professional footer with copyright information
      - Fully responsive design that works on all email clients
```